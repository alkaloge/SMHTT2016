if __name__ == "__main__":

    import ROOT
    import argparse

    fcentral=ROOT.TFile("files_nominal/ZTT.root","r")
    fshifted=ROOT.TFile("files_nominal/ZTT_dm.root","r")
    fnormalized=ROOT.TFile("files_nominal/ZTT_dm_norm.root","recreate")

    h00=fcentral.Get("mt_0jet/ZTT")
    h00_1=fshifted.Get("mt_0jet/ZTT_CMS_tauDMReco_1prong_13TeVUp")
    h00_1.Scale(h00.Integral()/h00_1.Integral())
    h00_2=fshifted.Get("mt_0jet/ZTT_CMS_tauDMReco_1prong_13TeVDown")
    h00_2.Scale(h00.Integral()/h00_2.Integral())
    h00_3=fshifted.Get("mt_0jet/ZTT_CMS_tauDMReco_1prong1pizero_13TeVUp")
    h00_3.Scale(h00.Integral()/h00_3.Integral())
    h00_4=fshifted.Get("mt_0jet/ZTT_CMS_tauDMReco_1prong1pizero_13TeVDown")
    h00_4.Scale(h00.Integral()/h00_4.Integral())
    h00_5=fshifted.Get("mt_0jet/ZTT_CMS_tauDMReco_3prong_13TeVUp")
    h00_5.Scale(h00.Integral()/h00_5.Integral())
    h00_6=fshifted.Get("mt_0jet/ZTT_CMS_tauDMReco_3prong_13TeVDown")
    h00_6.Scale(h00.Integral()/h00_6.Integral())

    h11=fcentral.Get("mt_boosted/ZTT")
    h11_1=fshifted.Get("mt_boosted/ZTT_CMS_tauDMReco_1prong_13TeVUp")
    h11_1.Scale(h11.Integral()/h11_1.Integral())
    h11_2=fshifted.Get("mt_boosted/ZTT_CMS_tauDMReco_1prong_13TeVDown")
    h11_2.Scale(h11.Integral()/h11_2.Integral())
    h11_3=fshifted.Get("mt_boosted/ZTT_CMS_tauDMReco_1prong1pizero_13TeVUp")
    h11_3.Scale(h11.Integral()/h11_3.Integral())
    h11_4=fshifted.Get("mt_boosted/ZTT_CMS_tauDMReco_1prong1pizero_13TeVDown")
    h11_4.Scale(h11.Integral()/h11_4.Integral())
    h11_5=fshifted.Get("mt_boosted/ZTT_CMS_tauDMReco_3prong_13TeVUp")
    h11_5.Scale(h11.Integral()/h11_5.Integral())
    h11_6=fshifted.Get("mt_boosted/ZTT_CMS_tauDMReco_3prong_13TeVDown")
    h11_6.Scale(h11.Integral()/h11_6.Integral())

    h0=fcentral.Get("mt_vbf_D0_0p0to0p2/ZTT")
    h0_1=fshifted.Get("mt_vbf_D0_0p0to0p2/ZTT_CMS_tauDMReco_1prong_13TeVUp")
    h0_1.Scale(h0.Integral()/h0_1.Integral())
    h0_2=fshifted.Get("mt_vbf_D0_0p0to0p2/ZTT_CMS_tauDMReco_1prong_13TeVDown")
    h0_2.Scale(h0.Integral()/h0_2.Integral())
    h0_3=fshifted.Get("mt_vbf_D0_0p0to0p2/ZTT_CMS_tauDMReco_1prong1pizero_13TeVUp")
    h0_3.Scale(h0.Integral()/h0_3.Integral())
    h0_4=fshifted.Get("mt_vbf_D0_0p0to0p2/ZTT_CMS_tauDMReco_1prong1pizero_13TeVDown")
    h0_4.Scale(h0.Integral()/h0_4.Integral())
    h0_5=fshifted.Get("mt_vbf_D0_0p0to0p2/ZTT_CMS_tauDMReco_3prong_13TeVUp")
    h0_5.Scale(h0.Integral()/h0_5.Integral())
    h0_6=fshifted.Get("mt_vbf_D0_0p0to0p2/ZTT_CMS_tauDMReco_3prong_13TeVDown")
    h0_6.Scale(h0.Integral()/h0_6.Integral())

    h1=fcentral.Get("mt_vbf_D0_0p2to0p4/ZTT")
    h1_1=fshifted.Get("mt_vbf_D0_0p2to0p4/ZTT_CMS_tauDMReco_1prong_13TeVUp")
    h1_1.Scale(h1.Integral()/h1_1.Integral())
    h1_2=fshifted.Get("mt_vbf_D0_0p2to0p4/ZTT_CMS_tauDMReco_1prong_13TeVDown")
    h1_2.Scale(h1.Integral()/h1_2.Integral())
    h1_3=fshifted.Get("mt_vbf_D0_0p2to0p4/ZTT_CMS_tauDMReco_1prong1pizero_13TeVUp")
    h1_3.Scale(h1.Integral()/h1_3.Integral())
    h1_4=fshifted.Get("mt_vbf_D0_0p2to0p4/ZTT_CMS_tauDMReco_1prong1pizero_13TeVDown")
    h1_4.Scale(h1.Integral()/h1_4.Integral())
    h1_5=fshifted.Get("mt_vbf_D0_0p2to0p4/ZTT_CMS_tauDMReco_3prong_13TeVUp")
    h1_5.Scale(h1.Integral()/h1_5.Integral())
    h1_6=fshifted.Get("mt_vbf_D0_0p2to0p4/ZTT_CMS_tauDMReco_3prong_13TeVDown")
    h1_6.Scale(h1.Integral()/h1_6.Integral())

    h2=fcentral.Get("mt_vbf_D0_0p4to0p8/ZTT")
    h2_1=fshifted.Get("mt_vbf_D0_0p4to0p8/ZTT_CMS_tauDMReco_1prong_13TeVUp")
    h2_1.Scale(h2.Integral()/h2_1.Integral())
    h2_2=fshifted.Get("mt_vbf_D0_0p4to0p8/ZTT_CMS_tauDMReco_1prong_13TeVDown")
    h2_2.Scale(h2.Integral()/h2_2.Integral())
    h2_3=fshifted.Get("mt_vbf_D0_0p4to0p8/ZTT_CMS_tauDMReco_1prong1pizero_13TeVUp")
    h2_3.Scale(h2.Integral()/h2_3.Integral())
    h2_4=fshifted.Get("mt_vbf_D0_0p4to0p8/ZTT_CMS_tauDMReco_1prong1pizero_13TeVDown")
    h2_4.Scale(h2.Integral()/h2_4.Integral())
    h2_5=fshifted.Get("mt_vbf_D0_0p4to0p8/ZTT_CMS_tauDMReco_3prong_13TeVUp")
    h2_5.Scale(h2.Integral()/h2_5.Integral())
    h2_6=fshifted.Get("mt_vbf_D0_0p4to0p8/ZTT_CMS_tauDMReco_3prong_13TeVDown")
    h2_6.Scale(h2.Integral()/h2_6.Integral())

    h4=fcentral.Get("mt_vbf_D0_0p8to1p0/ZTT")
    h4_1=fshifted.Get("mt_vbf_D0_0p8to1p0/ZTT_CMS_tauDMReco_1prong_13TeVUp")
    h4_1.Scale(h4.Integral()/h4_1.Integral())
    h4_2=fshifted.Get("mt_vbf_D0_0p8to1p0/ZTT_CMS_tauDMReco_1prong_13TeVDown")
    h4_2.Scale(h4.Integral()/h4_2.Integral())
    h4_3=fshifted.Get("mt_vbf_D0_0p8to1p0/ZTT_CMS_tauDMReco_1prong1pizero_13TeVUp")
    h4_3.Scale(h4.Integral()/h4_3.Integral())
    h4_4=fshifted.Get("mt_vbf_D0_0p8to1p0/ZTT_CMS_tauDMReco_1prong1pizero_13TeVDown")
    h4_4.Scale(h4.Integral()/h4_4.Integral())
    h4_5=fshifted.Get("mt_vbf_D0_0p8to1p0/ZTT_CMS_tauDMReco_3prong_13TeVUp")
    h4_5.Scale(h4.Integral()/h4_5.Integral())
    h4_6=fshifted.Get("mt_vbf_D0_0p8to1p0/ZTT_CMS_tauDMReco_3prong_13TeVDown")
    h4_6.Scale(h4.Integral()/h4_6.Integral())

    fnormalized.cd()
    dir00OS=fnormalized.mkdir("mt_0jet")
    dir00OS.cd()
    h00_1.Write()
    h00_2.Write()
    h00_3.Write()
    h00_4.Write()
    h00_5.Write()
    h00_6.Write()

    dir11OS=fnormalized.mkdir("mt_boosted")
    dir11OS.cd()
    h11_1.Write()
    h11_2.Write()
    h11_3.Write()
    h11_4.Write()
    h11_5.Write()
    h11_6.Write()

    dir0OS=fnormalized.mkdir("mt_vbf_D0_0p0to0p2")
    dir0OS.cd()
    h0_1.Write()
    h0_2.Write()
    h0_3.Write()
    h0_4.Write()
    h0_5.Write()
    h0_6.Write()

    dir1OS=fnormalized.mkdir("mt_vbf_D0_0p2to0p4")
    dir1OS.cd()
    h1_1.Write()
    h1_2.Write()
    h1_3.Write()
    h1_4.Write()
    h1_5.Write()
    h1_6.Write()

    dir1OS=fnormalized.mkdir("mt_vbf_D0_0p4to0p8")
    dir1OS.cd()
    h2_1.Write()
    h2_2.Write()
    h2_3.Write()
    h2_4.Write()
    h2_5.Write()
    h2_6.Write()

    dir1OS=fnormalized.mkdir("mt_vbf_D0_0p8to1p0")
    dir1OS.cd()
    h4_1.Write()
    h4_2.Write()
    h4_3.Write()
    h4_4.Write()
    h4_5.Write()
    h4_6.Write()
